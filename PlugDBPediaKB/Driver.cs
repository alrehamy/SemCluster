using System;
using System.Collections.Generic;
using System.Linq;
using Newtonsoft.Json;
using System.Net;
using WordNetApi.Core;
using System.IO;
using System.Text.RegularExpressions;

namespace PlugDBPediaKB
{
    public class ExternalHypernym
    {
        public string URI { get; set; }
    }
    public class ExternalSynSet
    {
        [JsonProperty("uri")]
        public string ID { get; set; }
        [JsonProperty("label")]
        public string Synonym { get; set; }
        [JsonProperty("description")]
        public string Gloss { get; set; }
        [JsonProperty("classes")]
        public List<ExternalHypernym> Hypernyms { get; set; }
        public bool IsCached { get; set; }
    }
    public class ExternalSet
    {
        [JsonProperty("results")]
        public List<ExternalSynSet> SynSets { get; set; }
    }
    public class Driver
    {
        #region Schema Mapping
        // Load Schema.owl directly In-Memory for faster access
        private static Dictionary<string, string> SchemaMap = new Dictionary<string, string>(756)
        {
        {"activity","1407535"},
		{"game","2455599"},
		{"boardgame","3502415"},
		{"cardgame","3488225"},
		{"sales","213260936"},
		{"sport","2523513"},
		{"athletics","3523513"},
		{"boxing","3445802"},
		{"horseriding","3450335"},
		{"teamsport","3887544"},
		{"soccer","4468480"},
		{"agent","19190918"},
		{"deity","29505418"},
		{"employer","210054657"},
		{"family","27970721"},
		{"noblefamily","310271677"},
		{"organisation","28008335"},
		{"broadcaster","39875786"},
		{"broadcastnetwork","46276697"},
		{"radiostation","44044119"},
		{"televisionstation","44406350"},
		{"company","38058098"},
		{"airline","42690081"},
		{"bank","48420278"},
		{"brewery","42897237"},
		{"buscompany","48186761"},
		{"caterer","49901642"},
		{"lawfirm","48064039"},
		{"publisher","48062623"},
		{"recordlabel","43924069"},
		{"winery","44592465"},
		{"educationalinstitution","38276342"},
		{"college","48278324"},
		{"library","43660909"},
		{"school","48276720"},
		{"university","48286569"},
		{"employersorganisation","37968702"},
		{"geopoliticalorganisation","38008335"},
		{"governmentagency","38337324"},
		{"governmentcabinet","48050678"},
		{"group","331264"},
		{"band","48240169"},
		{"comedygroup","46891493"},
		{"internationalorganisation","38293982"},
		{"legislature","38163273"},
		{"militaryunit","38198398"},
		{"non-profitorganisation","38009834"},
		{"recordoffice","47977870"},
		{"parliament","38319198"},
		{"politicalparty","38256968"},
		{"publictransitsystem","34473432"},
		{"religiousorganisation","31136519"},
		{"clericalorder","48149781"},
		{"sambaschool","38275185"},
		{"sportsclub","38227214"},
		{"hockeyclub","48227214"},
		{"sportsleague","38231184"},
		{"americanfootballleague","48232496"},
		{"australianfootballleague","48232496"},
		{"autoracingleague","48231499"},
		{"baseballleague","48231874"},
		{"basketballleague","48232299"},
		{"bowlingleague","48232410"},
		{"boxingleague","48232299"},
		{"canadianfootballleague","4232496"},
		{"cricketleague","48231499"},
		{"curlingleague","48231499"},
		{"cyclingleague","48231499"},
		{"fieldhockeyleague","48232603"},
		{"formulaoneracing","48231499"},
		{"golfleague","48231499"},
		{"handballleague","48231499"},
		{"icehockeyleague","48231499"},
		{"inlinehockeyleague","48231499"},
		{"lacrosseleague","48231499"},
		{"mixedmartialartsleague","48231499"},
		{"motorcycleracingleague","48231499"},
		{"paintballleague","48231499"},
		{"pololeague","48231499"},
		{"radiocontrolledracingleague","48231678"},
		{"rugbyleague","48231678"},
		{"soccerleague","48232496"},
		{"softballleague","48231678"},
		{"speedwayleague","48232299"},
		{"tennisleague","48232299"},
		{"videogamesleague","48232299"},
		{"volleyballleague","48232299"},
		{"sportsteam","38208560"},
		{"americanfootballteam","48080025"},
		{"australianfootballteam","48080025"},
		{"baseballteam","48079319"},
		{"basketballteam","48079852"},
		{"canadianfootballteam","48080025"},
		{"cricketteam","4887544"},
		{"cyclingteam","4887544"},
		{"formulaoneteam","4887544"},
		{"handballteam","4887544"},
		{"hockeyteam","48080386"},
		{"rugbyclub","4887544"},
		{"soccerclub","48080025"},
		{"nationalsoccerclub","58080025"},
		{"speedwayteam","4887544"},
		{"termofoffice","315291498"},
		{"tradeunion","38233056"},
		{"person","27846"},
		{"ambassador","39787534"},
		{"archeologist","39804806"},
		{"architect","39805475"},
		{"aristocrat","39807754"},
		{"artist","39812338"},
		{"actor","49765278"},
		{"adultactor","510564098"},
		{"voiceactor","59765278"},
		{"comedian","49940146"},
		{"comicscreator","410144055"},
		{"dancer","49989502"},
		{"fashiondesigner","49614315"},
		{"humorist","410191943"},
		{"musicalartist","410340312"},
		{"backscene","510426749"},
		{"classicalmusicartist","510340312"},
		{"instrumentalist","510340312"},
		{"guitarist","610151760"},
		{"musicdirector","59952539"},
		{"singer","510599806"},
		{"painter","410391653"},
		{"photographer","410426749"},
		{"sculptor","410566072"},
		{"astronaut","39818022"},
		{"athlete","39820263"},
		{"archerplayer","49805324"},
		{"athleticsplayer","410638922"},
		{"australianrulesfootballplayer","410439851"},
		{"badmintonplayer","410701180"},
		{"baseballplayer","49835506"},
		{"basketballplayer","49842047"},
		{"bodybuilder","49862845"},
		{"boxer","49870208"},
		{"amateurboxer","59870208"},
		{"bullfighter","49836160"},
		{"canoeist","49891470"},
		{"chessplayer","49915834"},
		{"cricketer","49977326"},
		{"cyclist","49986189"},
		{"dartsplayer","49992238"},
		{"fencer","410085217"},
		{"gaelicgamesplayer","410638922"},
		{"golfplayer","410136959"},
		{"gridironfootballplayer","410101634"},
		{"americanfootballplayer","510101634"},
		{"canadianfootballplayer","510101634"},
		{"gymnast","410153594"},
		{"handballplayer","49820263"},
		{"highdiver","410683349"},
		{"horserider","410185793"},
		{"jockey","410223177"},
		{"lacrosseplayer","410242682"},
		{"martialartist","49870208"},
		{"motorsportracer","410334009"},
		{"motorcyclerider","510334009"},
		{"motocycleracer","610334009"},
		{"speedwayrider","610334009"},
		{"racingdriver","510502576"},
		{"dtmracer","610502576"},
		{"formulaoneracer","610502576"},
		{"nascardriver","610502576"},
		{"rallydriver","610502576"},
		{"nationalcollegiateathleticassociationathlete","410255459"},
		{"netballplayer","49820263"},
		{"pokerplayer","49894654"},
		{"rower","410368920"},
		{"rugbyplayer","410101634"},
		{"snookerplayer","49854421"},
		{"snookerchamp","59854421"},
		{"soccerplayer","410618342"},
		{"squashplayer","49820263"},
		{"surfer","410679054"},
		{"swimmer","410683349"},
		{"tabletennisplayer","410701180"},
		{"teammember","410662162"},
		{"tennisplayer","410701180"},
		{"volleyballplayer","410759047"},
		{"beachvolleyballplayer","510759047"},
		{"waterpoloplayer","49820263"},
		{"wintersportplayer","49820263"},
		{"biathlete","510605253"},
		{"bobsleighathlete","510605253"},
		{"crosscountryskier","510605253"},
		{"curler","510605253"},
		{"figureskater","510604491"},
		{"icehockeyplayer","510179291"},
		{"nordiccombined","510605253"},
		{"skater","510604491"},
		{"ski_jumper","510605375"},
		{"skier","510605253"},
		{"speedskater","510634849"},
		{"wrestler","410793168"},
		{"sumowrestler","510674713"},
		{"beautyqueen","310500217"},
		{"businessperson","39882007"},
		{"celebrity","39903153"},
		{"chef","39963574"},
		{"cleric","39928136"},
		{"cardinal","49894143"},
		{"christianbishop","49857200"},
		{"christianpatriarch","410406905"},
		{"pope","410453533"},
		{"priest","410470779"},
		{"saint","410546850"},
		{"vicar","410750031"},
		{"coach","39931640"},
		{"americanfootballcoach","49931640"},
		{"collegecoach","49931640"},
		{"volleyballcoach","49931640"},
		{"criminal","39977660"},
		{"murderer","410338707"},
		{"serialkiller","510581464"},
		{"economist","310043643"},
		{"egyptologist","310047822"},
		{"engineer","39615807"},
		{"farmer","310078806"},
		{"fictionalcharacter","39587565"},
		{"comicscharacter","49587565"},
		{"animangacharacter","59587565"},
		{"disneycharacter","49587565"},
		{"mythologicalfigure","49587565"},
		{"narutocharacter","49587565"},
		{"soapcharacter","49587565"},
		{"horsetrainer","310185682"},
		{"journalist","310224578"},
		{"judge","310225219"},
		{"lawyer","310249950"},
		{"linguist","310264437"},
		{"memberresistancemovement","310315837"},
		{"militaryperson","310582746"},
		{"model","310324851"},
		{"monarch","310628644"},
		{"moviedirector","310088200"},
		{"noble","310271677"},
		{"officeholder","310371450"},
		{"organisationmember","310307234"},
		{"sportsteammember","49820263"},
		{"orphan","310384392"},
		{"philosopher","310423589"},
		{"playboyplaymate","310291240"},
		{"politician","310451263"},
		{"chancellor","49906986"},
		{"congressman","49955781"},
		{"deputy","410005280"},
		{"governor","410140314"},
		{"lieutenant","410259348"},
		{"mayor","410303814"},
		{"memberofparliament","410400437"},
		{"president","410467179"},
		{"primeminister","49907196"},
		{"senator","410578471"},
		{"vicepresident","410751265"},
		{"viceprimeminister","49907196"},
		{"politicianspouse","310640620"},
		{"presenter","310466387"},
		{"radiohost","410503710"},
		{"televisionhost","410697420"},
		{"producer","310480018"},
		{"psychologist","310488865"},
		{"referee","310514429"},
		{"religious","310518602"},
		{"romanemperor","310537240"},
		{"royalty","38153437"},
		{"britishroyalty","48153437"},
		{"baronet","59840639"},
		{"scientist","310560637"},
		{"biologist","49855630"},
		{"entomologist","410059904"},
		{"medician","410020890"},
		{"professor","410480730"},
		{"sportsmanager","39931640"},
		{"soccermanager","49931640"},
		{"televisiondirector","310088200"},
		{"televisionpersonality","310417424"},
		{"host","410187130"},
		{"theatredirector","310015215"},
		{"writer","310794014"},
		{"historian","410177150"},
		{"musiccomposer","49947232"},
		{"playwright","410030277"},
		{"poet","410444194"},
		{"screenwriter","410564400"},
		{"songwriter","410624540"},
		{"altitude","15131647"},
		{"anatomicalstructure","15225602"},
		{"artery","25333777"},
		{"bloodvessel","25417975"},
		{"bone","25269901"},
		{"brain","25481095"},
		{"embryology","26071426"},
		{"ligament","25295381"},
		{"lymph","25404074"},
		{"muscle","25289297"},
		{"nerve","25474346"},
		{"vein","25418717"},
		{"area","18497294"},
		{"award","113268146"},
		{"decoration","26706676"},
		{"nobelprize","27268759"},
		{"biomolecule","114682133"},
		{"enzyme","214732946"},
		{"gene","25436752"},
		{"humangene","35436752"},
		{"mousegene","35436752"},
		{"hormone","25407119"},
		{"lipid","214938907"},
		{"polysaccharide","214994004"},
		{"protein","214728724"},
		{"blazon","13058726"},
		{"chartsplacements","16999802"},
		{"chemicalsubstance","114806838"},
		{"chemicalcompound","214818238"},
		{"chemicalelement","214622893"},
		{"drug","23247620"},
		{"mineral","214662574"},
		{"colour","14956594"},
		{"currency","113385913"},
		{"demographics","16152125"},
		{"depth","15134547"},
		{"device","13183080"},
		{"camera","22942699"},
		{"digitalcamera","33196062"},
		{"engine","23287733"},
		{"automobileengine","32761557"},
		{"rocketengine","34099175"},
		{"informationappliance","23277771"},
		{"instrument","23574816"},
		{"guitar","33467517"},
		{"organ","33273551"},
		{"mobilephone","22992529"},
		{"weapon","24565375"},
		{"diploma","16478582"},
		{"disease","114070360"},
		{"electiondiagram","13186399"},
		{"ethnicgroup","17967382"},
		{"event","129378"},
		{"competition","27456188"},
		{"contest","37456188"},
		{"lifecycleevent","229378"},
		{"personalevent","330358"},
		{"birth","442541"},
		{"death","47355491"},
		{"divorce","41201271"},
		{"marriage","41036996"},
		{"societalevent","21080366"},
		{"academicconference","38308497"},
		{"attack","3766234"},
		{"convention","38309086"},
		{"election","3181781"},
		{"filmfestival","3517418"},
		{"meeting","38307589"},
		{"militaryconflict","3953559"},
		{"musicfestival","3517728"},
		{"rebellion","31177327"},
		{"spacemission","329378"},
		{"sportsevent","37456638"},
		{"cyclingcompetition","47459249"},
		{"footballmatch","47470671"},
		{"grandprix","47459066"},
		{"internationalfootballleagueevent","47456638"},
		{"mixedmartialartsevent","47456638"},
		{"nationalfootballleagueevent","47456638"},
		{"olympics","47457126"},
		{"olympicevent","57456638"},
		{"race","47472657"},
		{"cyclingrace","57459249"},
		{"horserace","57461411"},
		{"motorrace","57459642"},
		{"tournament","47464725"},
		{"golftournament","57464725"},
		{"soccertournament","57464725"},
		{"tennistournament","57464725"},
		{"womenstennisassociationtournament","57464725"},
		{"wrestlingevent","47456638"},
		{"flag","13354903"},
		{"food","121265"},
		{"beverage","27881800"},
		{"beer","37886849"},
		{"vodka","37906111"},
		{"wine","37891726"},
		{"controlleddesignationoforiginwine","47891726"},
		{"cheese","27850329"},
		{"genelocation","15436752"},
		{"humangenelocation","25436752"},
		{"mousegenelocation","25436752"},
		{"grossdomesticproduct","13748886"},
		{"grossdomesticproductpercapita","113451804"},
		{"holiday","115183428"},
		{"humandevelopmentindex","16639674"},
		{"language","16282651"},
		{"programminglanguage","26898352"},
		{"list","16487897"},
		{"tracklist","26591815"},
		{"meanoftransportation","14473432"},
		{"aircraft","22686568"},
		{"militaryaircraft","33335030"},
		{"automobile","22958343"},
		{"locomotive","23684823"},
		{"militaryvehicle","23764276"},
		{"motorcycle","23790512"},
		{"on-sitetransportation","24473432"},
		{"conveyorsystem","33100897"},
		{"escalator","36393800"},
		{"movingwalkway","33295773"},
		{"rocket","24099429"},
		{"ship","24194289"},
		{"spaceshuttle","24266014"},
		{"spacestation","24266162"},
		{"spacecraft","24264914"},
		{"train","24468005"},
		{"traincarriage","22959942"},
		{"tram","24469813"},
		{"media","113792842"},
		{"medicine","13740161"},
		{"name","16333653"},
		{"givenname","26337307"},
		{"surname","26336904"},
		{"naturalevent","17283608"},
		{"earthquake","27428954"},
		{"solareclipse","27368877"},
		{"stormsurge","211467018"},
		{"penaltyshootout","15163189"},
		{"personfunction","1582388"},
		{"politicalfunction","2582388"},
		{"profession","2582388"},
		{"place","18664443"},
		{"architecturalstructure","24341686"},
		{"amusementparkattraction","38494231"},
		{"rollercoaster","44102406"},
		{"waterride","4441824"},
		{"arena","34295881"},
		{"building","32913152"},
		{"casino","42977936"},
		{"castle","4980441"},
		{"factory","43316406"},
		{"historicbuilding","48624891"},
		{"hospital","43540595"},
		{"hotel","43542333"},
		{"museum","43800563"},
		{"prison","44005630"},
		{"religiousbuilding","43953416"},
		{"abbey","52667576"},
		{"church","53028079"},
		{"monastery","53781244"},
		{"mosque","53788195"},
		{"shrine","54210390"},
		{"synagogue","54374735"},
		{"temple","54407435"},
		{"restaurant","44081281"},
		{"shoppingmall","43965456"},
		{"skyscraper","44233124"},
		{"gate","33427909"},
		{"infrastructure","33387016"},
		{"airport","42692232"},
		{"dam","43160309"},
		{"dike","43160309"},
		{"launchpad","43647691"},
		{"lock","43683079"},
		{"port","48633957"},
		{"powerstation","43996655"},
		{"nuclearpowerstation","53997027"},
		{"restarea","44020744"},
		{"routeoftransportation","44096066"},
		{"bridge","52898711"},
		{"railwayline","53671272"},
		{"railwaytunnel","54048441"},
		{"road","54096066"},
		{"roadjunction","53581125"},
		{"roadtunnel","53895293"},
		{"waterwaytunnel","53895293"},
		{"station","44306080"},
		{"electricalsubstation","54348702"},
		{"fillingstation","53425092"},
		{"metrostation","54049098"},
		{"railwaystation","54049098"},
		{"tramstation","54049098"},
		{"militarystructure","33763133"},
		{"fort","43420559"},
		{"mill","33765561"},
		{"treadmill","44477219"},
		{"watermill","44561422"},
		{"windmotor","44587404"},
		{"windmill","44587559"},
		{"pyramid","34029125"},
		{"sportfacility","32752311"},
		{"cricketground","44295881"},
		{"golfcourse","43446528"},
		{"racetrack","44037625"},
		{"racecourse","54037625"},
		{"skiarea","44295881"},
		{"skiresort","58652376"},
		{"stadium","44295881"},
		{"square","38619620"},
		{"tower","34460130"},
		{"lighthouse","42814860"},
		{"watertower","44562935"},
		{"tunnel","33895293"},
		{"venue","38578706"},
		{"theatre","44417809"},
		{"zoo","33745146"},
		{"celestialbody","29239740"},
		{"asteroid","39208702"},
		{"constellation","39252970"},
		{"galaxy","38271042"},
		{"planet","39394646"},
		{"satellite","39424270"},
		{"artificialsatellite","44137444"},
		{"star","39444100"},
		{"browndwarf","49239740"},
		{"swarm","37996149"},
		{"globularswarm","47996149"},
		{"openswarm","47996149"},
		{"cemetery","28521623"},
		{"concentrationcamp","23086183"},
		{"countryseat","213251980"},
		{"garden","28615374"},
		{"historicplace","28624891"},
		{"mine","23768346"},
		{"coalpit","33056368"},
		{"monument","28600443"},
		{"gravemonument","34076713"},
		{"memorial","33743902"},
		{"naturalplace","29366762"},
		{"archipelago","39203827"},
		{"beach","39217230"},
		{"bodyofwater","39225146"},
		{"bay","49215664"},
		{"lake","49328904"},
		{"ocean","49376198"},
		{"sea","49426788"},
		{"stream","49448361"},
		{"canal","52947212"},
		{"creek","59229409"},
		{"river","59411430"},
		{"cape","39233715"},
		{"cave","39238926"},
		{"crater","39472413"},
		{"lunarcrater","49344324"},
		{"desert","38505573"},
		{"forest","38438533"},
		{"glacier","39289331"},
		{"hotspring","39305898"},
		{"mountain","39359803"},
		{"mountainpass","39386842"},
		{"mountainrange","39403734"},
		{"valley","39468604"},
		{"volcano","39472597"},
		{"park","28615149"},
		{"populatedplace","28513718"},
		{"agglomeration","32914991"},
		{"community","38553535"},
		{"continent","39254614"},
		{"country","38544813"},
		{"historicalcountry","48544813"},
		{"gatedcommunity","38553535"},
		{"intercommunality","38553535"},
		{"island","39316454"},
		{"atoll","49210862"},
		{"locality","38641113"},
		{"region","38630985"},
		{"administrativeregion","48491826"},
		{"clericaladministrativeregion","58552138"},
		{"deanery","63166514"},
		{"diocese","68550966"},
		{"parish","68223688"},
		{"governmentaladministrativeregion","58590369"},
		{"arrondissement","68540532"},
		{"canton","68540770"},
		{"department","68114861"},
		{"overseasdepartment","78548733"},
		{"district","68552138"},
		{"historicaldistrict","78587174"},
		{"districtwaterboard","68552138"},
		{"microregion","68552138"},
		{"municipality","68626283"},
		{"formermunicipality","78626283"},
		{"prefecture","68626947"},
		{"province","68654360"},
		{"historicalprovince","78654360"},
		{"regency","615298995"},
		{"submunicipality","68626283"},
		{"historicalareaofauthority","58587174"},
		{"fiefdom","68557754"},
		{"historicalregion","58587174"},
		{"naturalregion","58587174"},
		{"settlement","38374049"},
		{"city","48524735"},
		{"capital","58691669"},
		{"capitalofregion","58691669"},
		{"citydistrict","48537837"},
		{"historicalsettlement","48374049"},
		{"town","48665504"},
		{"village","48226699"},
		{"state","38654360"},
		{"street","34334599"},
		{"territory","38493064"},
		{"oldterritory","48493064"},
		{"protectedarea","28624891"},
		{"siteofspecialscientificinterest","28624891"},
		{"wineregion","28624891"},
		{"worldheritagesite","28624891"},
		{"polyhedron","18630039"},
		{"population","18179879"},
		{"publicservice","11210281"},
		{"relationship","131921"},
		{"ratio","213815449"},
		{"routestop","14412901"},
		{"species","18110373"},
		{"archaea","21347583"},
		{"bacteria","21348530"},
		{"eukaryote","21415626"},
		{"animal","315388"},
		{"amphibian","41627424"},
		{"arachnid","41769347"},
		{"bird","41503061"},
		{"crustacean","41974773"},
		{"fish","42512053"},
		{"insect","42159955"},
		{"mammal","41861778"},
		{"cat","52121620"},
		{"dog","52084071"},
		{"horse","52374451"},
		{"racehorse","62382948"},
		{"mollusca","41940488"},
		{"reptile","41661091"},
		{"fungus","312992868"},
		{"plant","317222"},
		{"clubmoss","413221529"},
		{"conifer","413108841"},
		{"cultivatedvariety","413084834"},
		{"cycad","411600372"},
		{"fern","411545714"},
		{"floweringplant","411665372"},
		{"grape","57758680"},
		{"ginkgo","411664418"},
		{"gnetophytes","411596486"},
		{"greenalga","41358572"},
		{"moss","411537506"},
		{"sportcompetitionresult","113945919"},
		{"olympicresult","213945919"},
		{"snookerworldranking","213945919"},
		{"sportsseason","115239579"},
		{"motorsportseason","215239579"},
		{"sportsteamseason","215239579"},
		{"baseballseason","215240389"},
		{"footballleagueseason","215240998"},
		{"nationalfootballleagueseason","315240998"},
		{"ncaateamseason","215239579"},
		{"soccerclubseason","215240998"},
		{"soccerleagueseason","215240998"},
		{"statistic","16021499"},
		{"timeperiod","115113229"},
		{"careerstation","2282613"},
		{"geologicalperiod","215247518"},
		{"historicalperiod","215254028"},
		{"periodofartisticstyle","24929422"},
		{"prehistoricalperiod","215254550"},
		{"protohistoricalperiod","26146260"},
		{"year","215204297"},
		{"yearinspaceflight","215113229"},
		{"topicalconcept","16599788"},
		{"academicsubject","25996646"},
		{"cardinaldirection","213827426"},
		{"fashion","25750657"},
		{"genre","23434943"},
		{"artisticgenre","33434943"},
		{"literarygenre","33434943"},
		{"moviegenre","33434943"},
		{"musicgenre","37071942"},
		{"ideology","25779568"},
		{"mathematicalconcept","25835747"},
		{"philosophicalconcept","25835747"},
		{"politicalconcept","26212839"},
		{"scientificconcept","25989479"},
		{"standard","26725067"},
		{"systemoflaw","26535222"},
		{"tax","213308999"},
		{"taxon","27992450"},
		{"theologicalconcept","26167328"},
		{"christiandoctrine","36790042"},
		{"type","27997703"},
		{"documenttype","35840188"},
		{"governmenttype","35840188"},
		{"unitofwork","113927383"},
		{"case","2582071"},
		{"legalcase","31182654"},
		{"project","2795720"},
		{"researchproject","3641820"},
		{"work","121939"},
		{"artwork","26998748"},
		{"painting","33876519"},
		{"sculpture","34157320"},
		{"cartoon","26780678"},
		{"anime","36616464"},
		{"hollywoodcartoon","36780678"},
		{"collectionofvaluables","24125021"},
		{"archive","32735086"},
		{"database","26637824"},
		{"biologicaldatabase","36637824"},
		{"document","26647206"},
		{"file","36508816"},
		{"image","33925226"},
		{"movingimage","46613686"},
		{"stillimage","43925226"},
		{"sound","34063868"},
		{"film","26613686"},
		{"lineoffashion","23323593"},
		{"musicalwork","27020895"},
		{"album","36591815"},
		{"artistdiscography","37059626"},
		{"classicalmusiccomposition","37037465"},
		{"musical","37019172"},
		{"nationalanthem","37049055"},
		{"opera","37026352"},
		{"single","37040939"},
		{"song","37048000"},
		{"eurovisionsongcontestentry","47020895"},
		{"radioprogram","26619428"},
		{"software","26566077"},
		{"videogame","2458890"},
		{"televisionepisode","26621771"},
		{"televisionseason","26621447"},
		{"televisionshow","26619428"},
		{"website","26359193"},
		{"writtenwork","26263369"},
		{"annotation","36763273"},
		{"reference","46763681"},
		{"article","36268096"},
		{"book","36410904"},
		{"novel","46367879"},
		{"lightnovel","56367879"},
		{"comic","36596364"},
		{"comicstrip","47003352"},
		{"manga","46596364"},
		{"manhua","6596364"},
		{"manhwa","46596364"},
		{"drama","36376154"},
		{"law","36532330"},
		{"letter","36624161"},
		{"multivolumepublication","36589574"},
		{"periodicalliterature","36593296"},
		{"academicjournal","46597466"},
		{"magazine","46595351"},
		{"newspaper","46267145"},
		{"undergroundjournal","46597466"},
		{"play","37007945"},
		{"poem","36377442"},
		{"quote","36613056"},
		{"resume","36469694"},
		{"statedresolution","36511874"},
		{"treaty","36773434"}
        };
        #endregion

        private Regex rx;

        public Driver()
        {
            rx = new Regex(@"[^\w\d ]", RegexOptions.Compiled);
        }

        public List<SynSet> Query(WordNetEngine _wn,string term)
        {
            try
            {
                HttpWebRequest request;
                ExternalSet obj;
                int SynsCount;
                string InternalSynSetId;
                string HypernymInfo;
                int tmpDepth;
                List<SynSet> Syns = new List<SynSet>();
                SynSet tmpSyn;

                request = WebRequest.Create("http://lookup.dbpedia.org/api/search.asmx/KeywordSearch?QueryString=" + term) as HttpWebRequest;
                request.Method = "Get";
                request.Accept = "application/json";
                using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)
                using (StreamReader reader = new StreamReader(response.GetResponseStream()))
                    obj = JsonConvert.DeserializeObject<ExternalSet>(reader.ReadToEnd());

                SynsCount = obj.SynSets.Count;
                if (SynsCount > 0)
                    for (int k = 0; k < SynsCount; k++)
                        if (MeasureOverlap(term, obj.SynSets[k].Synonym))
                        {
                            // If the Sense has classes, map directly to WordNet
                            if (obj.SynSets[k].Hypernyms.Count > 0)
                            {
                                tmpDepth = 0;
                                InternalSynSetId = "";
                                foreach (ExternalHypernym hypernym in obj.SynSets[k].Hypernyms)
                                {
                                    // if the class RDF Identifier has URL, extract only the concept
                                    if (hypernym.URI.StartsWith("ht"))
                                        hypernym.URI = hypernym.URI.Substring(hypernym.URI.LastIndexOf("/") + 1);
                                    hypernym.URI = hypernym.URI.Trim().ToLower();

                                    if (SchemaMap.TryGetValue(hypernym.URI, out HypernymInfo))
                                        if (tmpDepth < Convert.ToInt32(HypernymInfo[0]))
                                        {
                                            tmpDepth = Convert.ToInt32(HypernymInfo[0]);
                                            InternalSynSetId = HypernymInfo.Substring(1);
                                        }
                                }
                                if (InternalSynSetId != "")
                                {
                                    tmpSyn = _wn.GetSynSet("Noun:" + InternalSynSetId);
                                    if (obj.SynSets[k].Gloss != null)
                                        tmpSyn.Gloss = rx.Replace(obj.SynSets[k].Gloss, string.Empty);
                                    tmpSyn.URI = obj.SynSets[k].ID;
                                    Syns.Add(tmpSyn);
                                }
                            }
                            else
                                if (obj.SynSets[k].Synonym.Contains("("))
                                {
                                    List<SynSet> tmpSyns = _wn.GetSynSets(obj.SynSets[k].Synonym.Split('(', ')')[1], "noun");
                                    if (tmpSyns.Count > 0)
                                    {
                                        tmpSyn = tmpSyns.First();
                                        if (obj.SynSets[k].Gloss != null)
                                            tmpSyn.Gloss = rx.Replace(obj.SynSets[k].Gloss, string.Empty);
                                        tmpSyn.URI = obj.SynSets[k].ID;
                                        Syns.Add(tmpSyn);
                                    }
                                }
                                else
                                {
                                    // Infer a class from categries
                                }
                        }
                return Syns;
            }
            catch (Exception ex)
            {
                return null;
            }
        }

        private bool MeasureOverlap(string string1, string string2)
        {
            string[] t1 = string1.Split(' ');
            string[] t2 = string2.Split(' ');
            double min = Math.Min(t1.Length, t2.Length);

            if (min == 0)
                return false;

            if (t1.Intersect(t2, StringComparer.OrdinalIgnoreCase).Count() / min >= 0.5)
                return true;

            return false;
        }
    }
}